<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=content-security-policy content="default-src 'self'; connect-src 'self' https://www.clarity.ms https://j.clarity.ms https://www.google-analytics.com https://t.clarity.ms; child-src 'self'; font-src 'self' https://fonts.gstatic.com; form-action 'self'; frame-src 'self' https://secure.lglforms.com; img-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.google-analytics.com https://www.googletagmanager.com https://www.google.com https://clients1.google.com https://www.googleapis.com https://cse.google.com https://encrypted-tbn0.gstatic.com https://encrypted-tbn3.gstatic.com https://c.clarity.ms https://c.bing.com http://clients1.google.com https://www.nwtime.org; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cse.google.com https://www.google.com; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.google-analytics.com https://www.googletagmanager.com https://cse.google.com https://www.google.com https://www.clarity.ms https://secure.lglforms.com http://cse.google.com;"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel=canonical href=https://khronos.nwtime.org/about/how-khronos-works/><meta property="og:title" content="How does Khronos work?"><meta property="og:description" content="Learn more about the Khronos Project"><meta property="og:type" content="article"><meta property="og:url" content="https://khronos.nwtime.org/about/how-khronos-works/"><meta property="og:image" content="https://khronos.nwtime.org/images/featured.webp"><meta property="article:section" content="about"><meta property="og:site_name" content="Khronos Project"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://khronos.nwtime.org/images/featured.webp"><meta name=twitter:title content="How does Khronos work?"><meta name=twitter:description content="Learn more about the Khronos Project"><script>window.onload=demo;function demo(){document.getElementById("gsc-i-id1").setAttribute("placeholder","Search...")}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-H63EDCRVG5"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-H63EDCRVG5',{anonymize_ip:!0})</script><script type=text/javascript>(function(a,e,b,f,g,c,d){a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},c=e.createElement(f),c.async=1,c.src="https://www.clarity.ms/tag/"+g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d)})(window,document,"clarity","script","gq199cq7sv")</script><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com/ crossorigin><link href="https://fonts.googleapis.com/css?family=Nunito+Sans:400,400i,700,800,800i,900i&display=swap" rel=stylesheet><title>How does Khronos work?</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Learn more about the Khronos Project"><meta name=generator content="Hugo 0.83.1"><link rel=stylesheet href=/scss/nwtime.min.252da7994567836423374a7d476f06db.css media=screen></head><body><nav class="navbar navbar-expand-lg navbar-light"><div class=container-fluid><div><a class=navbar-brand href=https://www.nwtime.org><img height=80 width=80 src=https://khronos.nwtime.org/images/logo.png alt></a>
<a class=navbar-brand style=color:#1a79c0!important;font-size:18px;font-weight:700;margin-left:20px href=https://khronos.nwtime.org/>Khronos Project</a></div><div><button class="btn btn-primary btn-lg" type=button><a class="nav-item btn btn-primary btn-lg" style=text-decoration:none;text-transform:uppercase href=/donate/>Support<br>Khronos!</a></button></div></div><script async src="https://cse.google.com/cse.js?cx=7474c4c5ca53f79ef"></script><div class=gcse-search></ul></div></nav><div class=header-border></div><section class="section pt-0 pb-auto"><div class=container><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=https://khronos.nwtime.org/about/>About</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://khronos.nwtime.org/about/how-khronos-works/>How does Khronos work?</a></li></ol></nav><h1 id=how-does-khronos-work>How does Khronos work?</h1><h4 id=khronos-is-a-watchdog>Khronos is a watchdog</h4><p>A watchdog is a mechanism that runs in the background, continuously monitoring client clock (which is updated by NTPv4) and calculating an estimated offset. When the offset exceeds a predefined threshold, this is interpreted as the client experiencing a time shifting attack. In this case, Khronos updates the client&rsquo;s clock.</p><p>When the client is not under attack, Khronos is passive, allowing NTPv4 to control the client&rsquo;s clock and providing the ordinary high precision and accuracy of NTPv4.</p><hr><h4 id=khronos-design>Khronos design</h4><p>Khronos periodically queries a set of m (tens) servers at random out of a large (hundreds) server pool in each Khronos poll interval.</p><p>Then, given a sample from each server, Khronos discards outliers by discarding the lowest third of the samples' offset values and highest third of the samples' offset values. Khronos checks that the following two conditions hold for the remaining sampled offsets:</p><ul><li>The maximal distance between every two offsets does not exceed 2w.</li><li>The distance between the offsets average and Khronos inter-poll offset is at most ERR+2w.</li></ul><p>If both conditions are satisfied, the average of the offsets is set to be the &ldquo;Khronos time offset&rdquo;. Otherwise, resampling is performed.</p><p>This resampling process continues in subsequent Khronos poll intervals until the two conditions are both satisfied or the number of times the servers are re-sampled exceeds a &ldquo;Panic Trigger&rdquo; (K), in which case Khronos enters a &ldquo;Panic Mode&rdquo;.</p><p>In panic mode, Khronos queries all the servers in its local Khronos pool, orders the collected time samples from lowest to highest and eliminates the lowest third and the highest third of the samples. The client then averages over the remaining samples, and sets this average to be the new &ldquo;Khronos time offset&rdquo;.</p><p>For recommended parameters see section 3.3 of the <a href=https://datatracker.ietf.org/doc/draft-ietf-ntp-chronos/>IETF draft</a>.</p><p>Note that to minimize the load on NTP servers while providing high security, the Khronos poll interval is around 10 times the NTPv4 poll interval. In each Khronos poll interval, if the Khronos time offset exceeds a predetermined threshold (denoted as H), an attack is indicated.</p><hr></div></section><br><div style=text-align:center><button class="btn btn-primary btn-lg">
<a class="btn btn-primary btn-lg" href=/about/>About <img src=/images/icons/question-circle.svg></img></a></button>
<button class="btn btn-primary btn-lg">
<a class="btn btn-primary btn-lg" href=https://github.com/nwtime/khronos>Khronos Source Code <img src=/images/icons/download.svg></img></a></button>
<button class="btn btn-primary btn-lg">
<a class="btn btn-primary btn-lg" href=https://github.com/nwtime/khronos/issues>Report a Bug <img src=/images/icons/bug.svg></img></a></button>
<button class="btn btn-primary btn-lg">
<a class="btn btn-primary btn-lg" href=/documentation/>Documentation <img src=/images/icons/book.svg></img></a></button></div><br><nav class="site-footer navbar navbar-expand-sm mt-auto"><div class=container><ul class=navbar-nav></ul><ul class="mx-auto pt-3"><p>&copy; 2024 <a class="navbar-text text-white" href=https://www.nwtime.org>Network Time Foundation</a></p></ul></div></nav></body></html>